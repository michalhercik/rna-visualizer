<!DOCTYPE html>
<html>
  <head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <script type="text/javascript" src="main.js"></script>
    <script type="text/javascript">
      function callAnimateToTemplate(event) {
        const duration = +document.getElementById('duration').value;
        const interval = +document.getElementById('interval').value;
        main.animateToTemplate(event, duration, interval);
      }
    </script>
  </head>
  <body onload="main.init()">
    <div class="mb-3">
      <nav class="navbar navbar-expand-lg navbar-light bg-light rounded">
        <div class="collapse navbar-collapse justify-content-md-center">
          <ul class="nav nav-pills">
            <li class="nav-item">
              <a class="nav-link" href="#" onclick="main.navClick(event)">Alignment</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" onclick="main.navClick(event)">Layers</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" onclick="main.navClick(event)">Transformation</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="#" onclick="main.navClick(event)">Combination</a>
            </li>
          </ul>
        </div>
        <div class="mx-3">
          <dialog id="help" class="w-75">
            <div class="text-end">
              <input type="button" value="X" class="btn btn-danger btn-sm" onclick="document.getElementById('help').close()">
            </div>
            <div class="m-4">
              <h1 id="demo-help">Demo help</h1>
              <p> This is demonstration of a Typescript library for visualizing multiple RNA secondary structures using template-based generation of radial diagram for comparing structures between each other by mapping diagrams via template diagram. </p> 
              <h2 id="overview">Overview</h2>
              <ol type="1">
                <li><a href="#navigation-panel">Navigation panel</a> - to switch content of <a href="#control-panel">Control panel</a>.</li> 
                <li><a href="#control-panel">Control panel</a> - through this panel you can play with methods for visualizing and comparing RNA secondary structures seen on the <a href="#canvas">Canvas</a> as well as switching between structures. It's content can be changed via <a href="#navigation-panel">Navigation panel</a>.</li>
                <li><a href="#canvas">Canvas</a> - displaying RNA secondary structures and mediates some interactions with it.</li> 
                <li>Help - shows a dialog with this help text.</li>
              </ol>
              <img src="overview.png" alt="overview" class="img-fluid" />
              <h2 id="canvas">Canvas</h2>
              <p>Canvas is displaying structures as a radial diagrams. You can zoom or pan canvas as you wish and in some <a href="#navigation-panel">situations</a> by clicking on a nucleotide of a template structure or near it on the canvas all structures that has nucleotide that is mapped to the template nucleotide are aligned to that nucleotide.</p>
              <h2 id="control-panel">Control panel</h2>
              <p>Through this panel you can play with methods for visualizing and comparing RNA secondary structures seen on the <a href="#canvas">Canvas</a> as well as switching between structures. It's content can be changed via <a href="#navigation-panel">Navigation panel</a>. It's divided into four segments - general, alignment groups, transformation, structures.</p>
              <h3 id="general">General</h3>
              <ol type="1">
                <li>Switch between sets of a structures.</li>
                <li>turn on/off hover label which is displayed when you hover with mouse over a nucleotide on the <a href="#canvas">canvas</a>.</li>
                <li>Hide labels showing index of a nucleotide.</li>
                <li>Reset position of structures to origin (left upper corner).</li>
                <li>Change alpha for the <a href="#canvas">canvas</a>.</li>
                <li>Set alpha for the <a href="#canvas">canvas</a> to default value, which is proportional to number of displayed structures.</li>
              </ol>
              <p align="center">
              <img src="./general.png" width="300">
              </p>
              <h3 id="alignment-groups-help">Alignment groups</h3>
              <p>In alignment groups segment you can align structures by clicking on one of the buttons. Each button has number that represents potential number of aligned nucleotides so button with bigger number could align more nucleotides than button with smaller number but it's not a rule.</p>
              <p align="center">
              <img src="./alignment.png" width="300" />
              </p>
              <h3 id="transformation-help">Transformation</h3>
              <p>Transformation segment can be used for animated transformation of structures to and from template structure. It is divided into two parts. First part is hiding nucleotides which are not mapped to any template nucleotide. Second part is moving all other nucleotides to the position of their template nucleotides. 1. Duration of the animations second part in miliseconds 2. Delay between hiding each nucleotide in the animations first part. 3. Starts animated transformation.</p>
              <p align="center">
              <img src="./transformation.png" width="300" />
              </p>
              <h3 id="structures">Structures</h3>
              <ol type="1">
                <li>Shows/hides structure.</li>
                <li>If checked, the structure won't be transformed when clicking on <a href="#transformation-help">transform</a> button.</li>
                <li>Shows/hides mapping lines, which connects structure nucleotides with nucleotides in template structure to which they are mapped.</li>
              </ol>
              <p align="center">
              <img src="./structures.png" width="300" />
              </p>
              <h2 id="navigation-panel">Navigation panel</h2>
              <p>Changes content of <a href="#control-panel">control panel</a>. Navigation panel has four options - Alignment, Layers, Transformation and Combination. Alignment, Layers and Transformation isolates some methods for visualizing and comparing RNA secondary structures. The fourth option, Combination, is for working with all methods at once to explore the full potentional of the library.</p>
              <p>On the control panel you can always find <a href="#general">general segment</a> where you for example switch between set of structures. Besides general segment control panel always contains switch to turn on/off mapping lines for each structure at <a href="#structures">structures segment</a>.</p>
              <h3 id="alignment-help">Alignment</h3>
              <p>Alignment option is focusing on a alignment of structure diagrams. On the control panel is available <a href="#alignment-groups-help">alignment groups segment</a> where you can choose to which group of nucleotides will be the structures aligned. You can also align on a specific nucleotide by clicking on it on the <a href="#canvas">canvas</a>.</p> <h3 id="layers">Layers</h3>
              <p>For this option is additionaly available in <a href="#structures">structures segment</a> checkboxes for showing/hiding specific structures in a given set of structures.</p> 
              <h3 id="transformation-1">Transformation</h3>
              <p>Transformation option gives you <a href="#transformation-help">transformation segment</a> which is used for animated transformation of structures to template structure. You can also turn on/off transformation for specific structures in <a href="#structures">structure segment</a></p>
            </div>
          </dialog>

          <input type="button" value="Help" class="btn btn-info" onclick="document.getElementById('help').showModal()">
        </div>
      </nav>
    </div>
    <main class="container">
      <div class="row">
        <div class="col">
          <canvas id="rna-canvas"></canvas>
        </div>
        <div id="controls" class="col">
          <div id="general" class="border-bottom border-2 mb-3">
            <h6>General</h6>
            <div class="mb-3">
              <select id="structs-selector" class="form-select form-select-sm" aria-label=".form-select-sm example" onchange="main.reload(event.target.value)"></select>
            </div>
            <div class="mb-3">
              <div>
                <input class="form-check-input" type="checkbox" id="hover-title" name="hover-title" onchange="main.hoverLabel(event, document.getElementById('rna-canvas'))" checked>
                <label class="form-check-label" for="hover-title">hover title</label>
              </div>
              <div>
                <input class="form-check-input" type="checkbox" id="numbering-label" name="numbering-label" onchange="main.numberingLabel(event)" checked>
                <label class="form-check-label" for="numbering-label">numbering labels</label>
              </div>
            </div>
            <div class="mb-3">
              <input class="btn btn-primary btn-sm" type="button" value="Origin" id="reset-pos" onclick="main.centerStruct()">
            </div>
            <div class="mb-3">
              <label class="form-label" for="alpha-value">alpha</label><br>
              <input class="form-range w-75" type="range" min"0" max="1" value="1" step="0.05" id="alpha-value" onchange="main.changeAlpha(event)">
              <input class="btn btn-primary btn-sm" type="button" value="Default" onclick="main.setDefaultAlpha(document.getElementById('alpha-value'))">
            </div>
          </div>
          <div id="alignment" class="border-bottom border-2 mb-3">
            <h6>Alignment groups</h6>
            <div id="groups" class="mb-3"></div>
          </div>
          <div id="transformation" class="border-bottom border-2 mb-3">
            <h6>Transformation</h6>
            <div class="mb-2">
              <label class="form-label" for="duration">duration (ms)</label>
              <input class="form-control form-control-sm" type="number" id="duration" name"duration" value="1500" min="0" max="10000">
            </div>
            <div class="mb-2">
              <label class="form-label" for="interval">interval (ms)</label>
              <input class="form-control form-control-sm" type="number" id="interval" name"interval" value="0" min="0" max="10000">
            </div>
            <div class="mb-2">
              <input class="btn btn-primary btn-sm" type="button" value="Transform" onclick="callAnimateToTemplate(event)">
            </div>
          </div>
          <div id="structures" class="mb-3">
            <h6>Structures</h6>
            <div class="rotate"><div class="vertical">mapping lines</div><div id="transform-label" class="vertical">transform</div><div id="visible-label" class="vertical">visible</div></div>
            <ul id="struct-list" class="list-group-flush list"></ul>
          </div>
        </div>
      </div>
    </main>
  </body>
</html>
